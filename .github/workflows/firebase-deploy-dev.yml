# This file was auto-generated by the Firebase CLI
# https://github.com/firebase/firebase-tools

name: Deploy app to develop environment

on:
    push:
        branches: ["develop"]

env:
    NODE_VERSION: "18.13" # set this to the node version to use (e.g. '8.x', '10.x', '12.x')

jobs:
    build-and-deploy:
        runs-on: ubuntu-latest
        environment: dev
        steps:
            - name: Setup Node ${{ env.NODE_VERSION }} Environment
              uses: actions/setup-node@v3
              with:
                  node-version: ${{ env.NODE_VERSION }}

            - name: "Download dependencies and build"
              shell: bash
              run: |
                  yarn install
                  yarn build
                  cd functions
                  yarn install
                  yarn build
            - uses: actions/checkout@v3
            - run: firebase deploy
            - uses: FirebaseExtended/action-hosting-deploy@v0
              with:
                  repoToken: "${{ secrets.GITHUB_TOKEN }}"
                  firebaseServiceAccount: "${{ secrets.FIREBASE_SERVICE_ACCOUNT_SATIENCE_DEV }}"
                  channelId: live
                  projectId: satience-dev
